# HTTP报文

- **请求报文** 
    - **请求行** 请求方法 URL字段 HTTP协议版本 例如 `Get /api/userInfo HTTP/1.1`
    - **请求头** 
        - 涉及数据类型
            - `Accept` 浏览器可接受的响应体数据类型，例如请求css文件添加`text/css`，请求json数据的接口设置`application/json`
            - `Accept-encoding` 浏览器能够解码的编码方式，例如使用了压缩后的js或css代码，那么要给该请求头添加`gzip`
        - 涉及跨域
            - `Origin` 告知服务器发起请求的url
            - `access-control-request-method` 浏览器发起预检请求时，该请求头的值是要跨域访问的请求方法
            - `Access-Control-Request-Headers` 需要额外发送的请求头，因为CORS跨域对请求头设置的限制
        - 涉及用户信息验证
            - `Cookie` 验证发起请求的用户信息，如果有服务器有设置，不做其它处理的话，Cookie会自动携带到请求头中
        - 涉及缓存
            - `if-none-match` 如果请求的资源中有返回`Etag`响应头 下一次发起请求会自动携带该请求头用于判断缓存是否有效
            - `if-modified-since` 如果请求的资源中有返回`last-modified`响应头 下一次发起请求会自动携带该请求头用于判断缓存是否有效
    - **请求数据** 如果是GET请求，不会有请求数据，或者会把请求数据放在请求行中

- **响应报文**
    - **响应行** 由HTTP协议版本 状态码组成
    - **响应头**
        - 涉及数据类型
            - `content-type` 响应类型
            - `content-length` 响应内容长度
        - 涉及跨域
            - `access-control-allow-credentials` 是否运行请求携带cookie
            - `access-control-allow-origin` 允许发起跨域请求的url
            - `Access-Control-Request-Headers` 允许额外设置的请求头
            - `Access-Control-Request-Method` 允许跨域的请求方法
        - 涉及用户信息验证
            - `Set-cookie` 设置后，默认情况下浏览器下次发起请求就会在响应头中自动携带cookie
        - 涉及缓存
            - `expires` 资源过期时间
            - `cache-control` 控制缓存的方式
            - `Last-Modified` 最后一次在服务器修改的时间
            - `Etag` 根据服务器资源内容生成的hash值
        - 涉及安全
            - `content-security-policy` 设置可靠的资源（外部脚本、样式表、图片等等）加载，防止xss攻击
    - **响应体** 返回给客户端的响应数据

- **常见状态码**
    - 1xx 请求已经被接受，需要客户端继续处理
    - 2xx 请求成功 
        - 200成功且资源返回 
        - 204成功但是没有资源返回通常用于put请求 
    - 3xx 重定向到另一个资源 
        - 301 永久性重定向 允许将请求方法重定向到get请求
        - 302 暂时性重定向 但是可能会将用户重定向请求修改为get请求
        - 303 服务器已经执行 但响应主体不随本次请求返回 客户端需要向响应头的location字段值重新发起get请求
        - 307 服务器尚未执行 客户端需要向响应头的location字段重新提交(post/put/delete)请求
        - 304 用户请求的资源没有变更，告知客户端继续使用原来的资源
    - 4xx 客户端错误
        - 400 请求方法错误
        - 401 用户未经授权
        - 403 禁止访问
        - 404 访问资源不存在
    - 5xx 服务端错误
        - 500 服务器报错
        - 502 服务器作为网关或代理，从上游服务器收到无效响应
        - 503 服务器目前无法使用
        - 504 服务器作为网关或代理，但是没有及时从上游服务器收到请求
        - 505 服务器不支持请求中所用的 HTTP 协议版本

